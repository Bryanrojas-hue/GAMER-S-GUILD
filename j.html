<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador CiberCaf√© Gamer</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configuraci√≥n personalizada de Tailwind para colores y sombreado de ne√≥n -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'neon-blue': '#40e0d0', // Turquesa/Cian
                        'neon-purple': '#9370db', // P√∫rpura medio
                        'dark-bg': '#1a1a2e', // Negro azulado profundo
                        'dark-card': '#161625', // Negro muy oscuro
                    },
                    boxShadow: {
                        'neon': '0 0 8px rgba(147, 112, 219, 0.7), 0 0 16px rgba(64, 224, 208, 0.5)',
                        'neon-blue-sm': '0 0 4px rgba(64, 224, 208, 0.9)',
                        'neon-purple-sm': '0 0 4px rgba(147, 112, 219, 0.9)',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Estilo para las luces LED que rodean los elementos */
        .neon-border {
            box-shadow: 0 0 5px var(--tw-neon-purple), 0 0 10px var(--tw-neon-blue);
            transition: all 0.2s ease-in-out;
        }

        .neon-border:hover {
            box-shadow: 0 0 10px var(--tw-neon-blue), 0 0 20px var(--tw-neon-purple);
        }

        .text-neon-blue {
            color: #40e0d0;
            text-shadow: 0 0 4px rgba(64, 224, 208, 0.5);
        }

        .text-neon-purple {
            color: #9370db;
            text-shadow: 0 0 4px rgba(147, 112, 219, 0.5);
        }

        .btn-neon {
            background-color: #9370db;
            color: white;
            box-shadow: 0 0 8px #9370db;
            transition: all 0.15s;
        }

        .btn-neon:hover {
            background-color: #40e0d0;
            box-shadow: 0 0 10px #40e0d0, 0 0 15px #9370db;
        }

        /* Iconos simples para representar PC y Consola */
        .icon-pc::before {
            content: "üíª"; /* Computadora de escritorio */
            font-size: 2rem;
            line-height: 1;
        }
        .icon-console::before {
            content: "üéÆ"; /* Control de videojuegos */
            font-size: 2rem;
            line-height: 1;
        }
    </style>
</head>
<body class="bg-dark-bg text-white font-sans min-h-screen p-4 sm:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-neon-blue" style="text-shadow: 0 0 10px #40e0d0;">
                <span class="text-neon-purple">Ciber</span>Caf√© <span class="text-neon-blue">Gamer</span> Manager
            </h1>
            <p class="text-lg text-gray-300 mt-2">Tarifas: PC $20/hr | Consola $35/hr</p>
        </header>

        <main>
            
            <h2 class="text-3xl font-bold text-neon-blue mb-4 mt-6 border-b border-neon-blue/50 pb-2">üñ•Ô∏è Estaciones de Computadoras (PC)</h2>
            <!-- Contenedor para las 6 PCs -->
            <div id="estaciones-pc-grid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4">
                <!-- Tarjetas de PC generadas aqu√≠ -->
            </div>

            <h2 class="text-3xl font-bold text-neon-purple mb-4 mt-8 border-b border-neon-purple/50 pb-2">üéÆ Estaciones de Consolas</h2>
            <!-- Contenedor para las 4 Consolas -->
            <div id="estaciones-consola-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Tarjetas de Consola generadas aqu√≠ -->
            </div>


            <!-- Resumen de Totales -->
            <div class="mt-8 p-4 bg-dark-card rounded-xl shadow-neon border border-neon-purple/50">
                <h2 class="text-2xl font-bold text-neon-purple mb-3">Resumen de Totales</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-2 rounded-lg bg-dark-bg/50 shadow-neon-blue-sm">
                        <p class="text-xs text-gray-400">Sesiones Activas</p>
                        <p id="total-activas" class="text-2xl font-bold text-neon-blue">0</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-dark-bg/50 shadow-neon-purple-sm">
                        <p class="text-xs text-gray-400">Total Recaudado</p>
                        <p id="total-recaudado" class="text-2xl font-bold text-neon-purple">$0.00</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ----------------- CONFIGURACI√ìN Y ESTADO INICIAL -----------------

        // Definici√≥n de las 6 computadoras (PC) y 4 consolas (CONSOLA)
        const estacionesData = [
            { id: 1, tipo: 'PC', tarifa: 20 },
            { id: 2, tipo: 'PC', tarifa: 20 },
            { id: 3, tipo: 'PC', tarifa: 20 },
            { id: 4, tipo: 'PC', tarifa: 20 },
            { id: 5, tipo: 'PC', tarifa: 20 },
            { id: 6, tipo: 'PC', tarifa: 20 },
            { id: 7, tipo: 'CONSOLA', tarifa: 35 },
            { id: 8, tipo: 'CONSOLA', tarifa: 35 },
            { id: 9, tipo: 'CONSOLA', tarifa: 35 },
            { id: 10, tipo: 'CONSOLA', tarifa: 35 },
        ];

        // Estado global para las sesiones
        let sesiones = estacionesData.map(estacion => ({
            ...estacion,
            activo: false,
            tiempoInicio: 0, // Timestamp de inicio
            intervalo: null, // Referencia al setInterval para actualizar el tiempo/costo
            tiempoTranscurrido: 0, // Segundos totales
            costo: 0.00,
        }));

        let totalRecaudado = 0.00;

        // ----------------- FUNCIONES DE UTILIDAD Y C√ÅLCULO -----------------

        /**
         * Formatea el tiempo transcurrido (en segundos) a HH:MM:SS.
         * @param {number} segundos - Tiempo en segundos.
         * @returns {string} Tiempo formateado.
         */
        function formatearTiempo(segundos) {
            const h = Math.floor(segundos / 3600);
            const m = Math.floor((segundos % 3600) / 60);
            const s = segundos % 60;
            return [h, m, s].map(v => v.toString().padStart(2, '0')).join(':');
        }

        /**
         * Calcula el costo basado en la tarifa por hora y el tiempo transcurrido.
         * @param {number} segundos - Tiempo transcurrido en segundos.
         * @param {number} tarifaPorHora - Tarifa de la estaci√≥n por hora.
         * @returns {number} Costo calculado (redondeado a dos decimales).
         */
        function calcularCosto(segundos, tarifaPorHora) {
            // Convierte segundos a una fracci√≥n de hora
            const horas = segundos / 3600;
            const costo = horas * tarifaPorHora;
            return parseFloat(costo.toFixed(2));
        }

        /**
         * Actualiza el estado del DOM (tiempo y costo) para una estaci√≥n.
         * @param {object} estacion - El objeto de la sesi√≥n.
         */
        function actualizarEstacionDOM(estacion) {
            const elemento = document.getElementById(`estacion-${estacion.id}`);
            if (!elemento) return;

            // Actualiza el tiempo transcurrido
            const tiempoElement = elemento.querySelector('.tiempo-transcurrido');
            if (tiempoElement) {
                tiempoElement.textContent = formatearTiempo(estacion.tiempoTranscurrido);
            }

            // Actualiza el costo
            const costoElement = elemento.querySelector('.costo-actual');
            if (costoElement) {
                costoElement.textContent = `$${estacion.costo.toFixed(2)}`;
            }

            // Cambia el texto y estilo del bot√≥n de INICIAR/FINALIZAR
            const botonToggle = elemento.querySelector('.btn-toggle');
            if (botonToggle) {
                botonToggle.textContent = estacion.activo ? 'FINALIZAR' : 'INICIAR';
                
                // Estilo del bot√≥n de finalizaci√≥n (rojo)
                botonToggle.classList.toggle('btn-neon', !estacion.activo);
                botonToggle.classList.toggle('bg-red-600', estacion.activo);
                botonToggle.classList.toggle('hover:bg-red-700', estacion.activo);
                botonToggle.classList.toggle('shadow-neon', !estacion.activo);
                botonToggle.classList.toggle('shadow-red-500/50', estacion.activo);
            }
            
            // Maneja el bot√≥n de a√±adir tiempo
            const botonAddTime = elemento.querySelector('.btn-add-time');
            if (botonAddTime) {
                // Solo visible y con layout ajustado si est√° activo
                if (estacion.activo) {
                    elemento.querySelector('.button-container').classList.remove('justify-center');
                    botonAddTime.style.display = 'block';
                    botonToggle.classList.remove('w-full');
                    botonToggle.classList.add('flex-1');
                } else {
                    elemento.querySelector('.button-container').classList.add('justify-center');
                    botonAddTime.style.display = 'none';
                    botonToggle.classList.add('w-full');
                    botonToggle.classList.remove('flex-1');
                }
            }
        }

        // ----------------- L√ìGICA DE SESIONES -----------------

        /**
         * Agrega tiempo a una sesi√≥n activa.
         * @param {number} id - ID de la estaci√≥n.
         * @param {number} minutos - Cantidad de minutos a a√±adir.
         */
        window.agregarTiempo = function(id, minutos) {
            const estacionIndex = sesiones.findIndex(s => s.id === id);
            if (estacionIndex === -1) return;

            const estacion = sesiones[estacionIndex];

            // Solo permite a√±adir tiempo a sesiones activas
            if (!estacion.activo) {
                return; 
            }

            const msToAdd = minutos * 60 * 1000; // Convierte minutos a milisegundos

            // Ajusta el tiempo de inicio hacia el pasado para simular el tiempo a√±adido.
            // Esto es crucial para que el c√°lculo en el intervalo (Date.now() - tiempoInicio) se extienda.
            estacion.tiempoInicio -= msToAdd;

            // Recalcula el tiempo y costo inmediatamente
            const ahora = Date.now();
            const msTranscurridos = ahora - estacion.tiempoInicio;
            estacion.tiempoTranscurrido = Math.floor(msTranscurridos / 1000);
            estacion.costo = calcularCosto(estacion.tiempoTranscurrido, estacion.tarifa);

            actualizarEstacionDOM(estacion);
        }

        /**
         * Inicia una sesi√≥n para una estaci√≥n.
         * @param {number} id - ID de la estaci√≥n.
         */
        function iniciarSesion(id) {
            const estacionIndex = sesiones.findIndex(s => s.id === id);
            if (estacionIndex === -1 || sesiones[estacionIndex].activo) return;

            const estacion = sesiones[estacionIndex];
            estacion.activo = true;
            estacion.tiempoInicio = Date.now();
            estacion.tiempoTranscurrido = 0;
            estacion.costo = 0.00;

            // Inicia el contador
            estacion.intervalo = setInterval(() => {
                const ahora = Date.now();
                // Calcula el tiempo transcurrido en milisegundos
                const msTranscurridos = ahora - estacion.tiempoInicio;
                // Convierte a segundos
                estacion.tiempoTranscurrido = Math.floor(msTranscurridos / 1000);
                // Recalcula el costo
                estacion.costo = calcularCosto(estacion.tiempoTranscurrido, estacion.tarifa);

                actualizarEstacionDOM(estacion);
                actualizarResumen();
            }, 1000); // Actualiza cada segundo

            actualizarEstacionDOM(estacion);
            actualizarResumen();
        }

        /**
         * Finaliza una sesi√≥n y cobra.
         * @param {number} id - ID de la estaci√≥n.
         */
        function finalizarSesion(id) {
            const estacionIndex = sesiones.findIndex(s => s.id === id);
            if (estacionIndex === -1 || !sesiones[estacionIndex].activo) return;

            const estacion = sesiones[estacionIndex];

            // Detiene el intervalo de actualizaci√≥n
            clearInterval(estacion.intervalo);

            // Calcula el costo final
            const costoFinal = estacion.costo;
            totalRecaudado += costoFinal;

            // Reinicia el estado de la sesi√≥n
            estacion.activo = false;
            estacion.tiempoInicio = 0;
            estacion.intervalo = null;
            estacion.tiempoTranscurrido = 0;
            estacion.costo = 0.00;

            actualizarEstacionDOM(estacion);
            actualizarResumen();
        }

        /**
         * Maneja el clic en el bot√≥n Iniciar/Finalizar.
         * @param {number} id - ID de la estaci√≥n.
         */
        window.toggleSesion = function(id) {
            const estacion = sesiones.find(s => s.id === id);
            if (estacion) {
                if (estacion.activo) {
                    finalizarSesion(id);
                } else {
                    iniciarSesion(id);
                }
            }
        }

        // ----------------- ACTUALIZACI√ìN DE UI GLOBAL -----------------

        /**
         * Actualiza el contador de sesiones activas y el total recaudado.
         */
        function actualizarResumen() {
            const activas = sesiones.filter(s => s.activo).length;
            document.getElementById('total-activas').textContent = activas;
            document.getElementById('total-recaudado').textContent = `$${totalRecaudado.toFixed(2)}`;
        }

        // ----------------- INICIALIZACI√ìN DE LA APLICACI√ìN -----------------

        /**
         * Crea el HTML de la tarjeta para cada estaci√≥n.
         */
        function renderEstaciones() {
            const gridPC = document.getElementById('estaciones-pc-grid');
            const gridConsola = document.getElementById('estaciones-consola-grid');
            
            let htmlPC = '';
            let htmlConsola = '';

            // Genera el HTML para cada estaci√≥n
            sesiones.forEach(estacion => {
                const isPC = estacion.tipo === 'PC';
                const iconClass = isPC ? 'icon-pc' : 'icon-console';
                const typeColor = isPC ? 'text-neon-blue' : 'text-neon-purple';
                const shadowClass = isPC ? 'shadow-neon-blue-sm' : 'shadow-neon-purple-sm';
                
                // Muestra el ID correcto para Consola (1 a 4)
                const displayId = isPC ? estacion.id : estacion.id - 6;
                const title = isPC ? `Computadora ${displayId}` : `Consola ${displayId}`;

                const cardHtml = `
                    <div id="estacion-${estacion.id}" class="bg-dark-card p-4 rounded-xl neon-border flex flex-col items-center text-center ${shadowClass}">
                        <div class="${iconClass} ${typeColor} mb-2"></div>
                        <h3 class="text-xl font-bold ${typeColor}">${title}</h3>
                        <p class="text-xs text-gray-400">TARIFA: $${estacion.tarifa}/hr</p>
                        
                        <div class="mt-3 w-full">
                            <p class="text-sm font-semibold text-gray-300">Tiempo</p>
                            <p class="tiempo-transcurrido text-2xl font-mono text-white">00:00:00</p>
                        </div>
                        
                        <div class="mt-2 w-full">
                            <p class="text-sm font-semibold text-gray-300">Costo</p>
                            <p class="costo-actual text-3xl font-extrabold text-neon-blue">$0.00</p>
                        </div>
                        
                        <!-- Contenedor de Botones - Flex para la nueva funcionalidad -->
                        <div class="button-container mt-4 w-full flex space-x-2 justify-center">
                            <!-- Bot√≥n de A√±adir Tiempo (Inicia oculto) -->
                            <button onclick="agregarTiempo(${estacion.id}, 15)" 
                                    style="display: none;"
                                    class="btn-add-time flex-1 py-2 rounded-lg font-bold uppercase text-xs transition duration-150 bg-neon-purple/70 hover:bg-neon-purple shadow-neon-purple-sm text-white">
                                +15 Min
                            </button>

                            <!-- Bot√≥n Principal (Toggle) - Inicia ancho completo -->
                            <button onclick="toggleSesion(${estacion.id})" 
                                    class="btn-toggle w-full py-2 rounded-lg font-bold uppercase transition duration-150 btn-neon">
                                INICIAR
                            </button>
                        </div>
                    </div>
                `;
                
                if (isPC) {
                    htmlPC += cardHtml;
                } else {
                    htmlConsola += cardHtml;
                }
            });

            // Inserta el HTML en los contenedores separados
            if (gridPC) gridPC.innerHTML = htmlPC;
            if (gridConsola) gridConsola.innerHTML = htmlConsola;
        }

        // Inicia la aplicaci√≥n al cargar la ventana
        window.onload = () => {
            renderEstaciones();
            actualizarResumen();
        };

    </script>
</body>
</html>